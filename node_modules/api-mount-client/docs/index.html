<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>api-mount-client</title>
	<meta name="description" content="Documentation for api-mount-client">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">api-mount-client</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>api-mount-client</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#api-mount-client" id="api-mount-client" style="color: inherit; text-decoration: none;">
					<h1>api-mount-client</h1>
				</a>
				<p><em>by Vytenis Urbonaviƒçius</em></p>
				<p><em>api-mount-client</em> provides a straightforward way for reaching back-end API served using <a href="http://npmjs.com/package/api-mount-server">api-mount-server</a> or a compatible library.</p>
				<p>Once setup, it makes it feel as if server-side API methods are called directly.</p>
				<p>This library is based on <a href="http://npmjs.com/package/api-link">api-link</a> which is dedicating request functionality to either browser&#39;s <em>fetch</em> API or a <em>node-fetch</em> in a <em>Node</em> environment.</p>
				<hr>
				<a href="#installation" id="installation" style="color: inherit; text-decoration: none;">
					<h2>Installation</h2>
				</a>
				<p>Consider using a more universal library - <a href="http://npmjs.com/package/api-mount">api-mount</a>. <em>api-mount</em> contains both server and client code in one package. Usage and available methods are identical to <em>api-mount-client</em>. Only package name differs.</p>
				<p>If you want to continue using a client-only version:</p>
				<pre><code>npm <span class="hljs-keyword">install</span> <span class="hljs-comment">--save api-mount-client</span></code></pre>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p>On your <em>Node</em> server build an object containing API methods (more information and alternative ways of constructing <em>API</em> are provided in the docs of <a href="http://npmjs.com/package/api-mount-server">api-mount-server</a>):</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> api = {
  foo() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;foo&#x27;</span>
  },
}</code></pre>
				<p>In case your back-end is not based on <em>Node</em> but you would still want to use <em>api-mount-client_, you can explore _Protocol</em> section in the docs of <a href="http://npmjs.com/package/api-mount-server">api-mount-server</a>.</p>
				<p>Expose API via <a href="http://npmjs.com/package/api-mount-server">api-mount-server</a> (see docs of <a href="http://npmjs.com/package/api-mount-server">api-mount-server</a> to explore different approaches, usage of classes, namespacing, etc.):</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> {apiMountFactory} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;api-mount-server&#x27;</span>)
<span class="hljs-keyword">const</span> ApiMount = apiMountFactory()
ApiMount.exposeApi(api)</code></pre>
				<p>In case you have client and server on different hosts/ports, you might run into browser&#39;s <em>CORS</em> policy restrictions. Unless handled requests may get blocked or responses may be incomplete. Below is an example using <em>cors</em> <em>NPM</em> package for working around browser&#39;s <em>CORS</em> policy constraint:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> ApiMount = apiMountFactory({
  beforeListen: <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> {
    <span class="hljs-comment">// This is just for testing purposes</span>
    <span class="hljs-comment">// You would probably want to explicitly list</span>
    <span class="hljs-comment">// where you expect requests to be coming from</span>
    <span class="hljs-comment">// for security reasons</span>
    app.use(<span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cors&#x27;</span>)())
  },
})</code></pre>
				<p>On client side (browser or <em>Node</em> client) mount the <em>API</em>:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">import</span> {mountApi} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;api-mount-client&#x27;</span>
<span class="hljs-keyword">const</span> api = mountApi({baseUrl: <span class="hljs-string">&#x27;http://someServer.com:3000&#x27;</span>})</code></pre>
				<p>If your <em>API</em> is namespaced, attach your namespace path to the <em>baseUrl</em> of <em>mountApi</em>:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> api = mountApi({baseUrl: <span class="hljs-string">&#x27;http://someServer.com:3000/api-name&#x27;</span>})</code></pre>
				<p>Now you can access function on server from your client just like that:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> api.foo() <span class="hljs-comment">// &#x27;foo&#x27;</span></code></pre>
				<p>Note that client always receives a <em>Promise</em> object. This is why <em>await</em> was used. In case <em>foo</em> rejects a promise or throws an exception, client will reject a promise with error as a payload.</p>
				<a href="#try-it-out" id="try-it-out" style="color: inherit; text-decoration: none;">
					<h2>Try it out!</h2>
				</a>
				<p>In order to test library on vanilla <em>JavaScript</em> directly in browser, you can refer to this example:</p>
				<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Test<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./node_modules/api-mount-client/dist/index.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">const</span> api = <span class="hljs-built_in">window</span>.ApiMountClient.mountApi({
        <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">&#x27;http://localhost:3000&#x27;</span>,
      })

      api.test().then(<span class="hljs-built_in">console</span>.log)
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
				<p><em>api-mount-client</em> is exposed as a UMD library and therefore it is available in global scope if no other way of importing is available.</p>
				<p>Above example assumes that <em>API</em> was exposed using <em>Node</em> code like this:</p>
				<pre><code class="language-typescript"><span class="hljs-keyword">const</span> {apiMountFactory} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;api-mount-server&#x27;</span>)
<span class="hljs-keyword">var</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cors&#x27;</span>)

<span class="hljs-keyword">const</span> ApiMount = apiMountFactory({
  beforeListen: <span class="hljs-function"><span class="hljs-params">app</span> =&gt;</span> app.use(cors()),
})

<span class="hljs-keyword">const</span> api = {
  test = <span class="hljs-function">() =&gt;</span> <span class="hljs-string">&#x27;works!&#x27;</span>,
}

ApiMount.exposeApi(api)</code></pre>
				<a href="#supported-configuration" id="supported-configuration" style="color: inherit; text-decoration: none;">
					<h2>Supported Configuration</h2>
				</a>
				<p><em>mountApi</em> supports a configuration which contains following keys:</p>
				<ul>
					<li>baseUrl - base URL for HTTP requests. It may contain a protocol, host, port and base path but should not contain end-point method names and/or query arguments.</li>
					<li>fetchConfig - <em>fetch</em> API configuration which is passed through to the browser&#39;s <em>fetch</em> API or a server-side equivalent. Additional documentation can be found under <em>/docs</em> directory inside <a href="http://npmjs.com/package/api-link">api-link</a> package. One common case of using <em>fetchConfig</em> is to modify headers. Please note that provided headers completely override default ones. Please make sure that <em>Content-Type</em> is provided correctly. Normally it should be setup for JSON usage:</li>
				</ul>
				<pre><code class="language-typescript"><span class="hljs-comment">// ...</span>
  fetchConfig: {
    requestInit: {
      headers: {
        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,
        <span class="hljs-comment">// Other headers may go here</span>
      },
    },
  },
<span class="hljs-comment">// ...</span></code></pre>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-interface">
						<a href="interfaces/imountapioptions.html" class="tsd-kind-icon">IMount<wbr>Api<wbr>Options</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="globals.html#mountapi" class="tsd-kind-icon">mount<wbr>Api</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="assets/js/search.js"><' + '/script>');</script>
</body>
</html>